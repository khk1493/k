<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>

<HEAD>
<META NAME="Generator" CONTENT="Hancom HWP 9.1.0.2509">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<TITLE>Logistic Regression</TITLE>
<STYLE type="text/css">
<!--
p.HStyle0
	{style-name:"바탕글"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle0
	{style-name:"바탕글"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle0
	{style-name:"바탕글"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle1
	{style-name:"본문"; margin-left:15.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle1
	{style-name:"본문"; margin-left:15.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle1
	{style-name:"본문"; margin-left:15.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle2
	{style-name:"개요 1"; margin-left:10.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle2
	{style-name:"개요 1"; margin-left:10.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle2
	{style-name:"개요 1"; margin-left:10.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle3
	{style-name:"개요 2"; margin-left:20.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle3
	{style-name:"개요 2"; margin-left:20.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle3
	{style-name:"개요 2"; margin-left:20.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle4
	{style-name:"개요 3"; margin-left:30.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle4
	{style-name:"개요 3"; margin-left:30.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle4
	{style-name:"개요 3"; margin-left:30.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle5
	{style-name:"개요 4"; margin-left:40.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle5
	{style-name:"개요 4"; margin-left:40.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle5
	{style-name:"개요 4"; margin-left:40.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle6
	{style-name:"개요 5"; margin-left:50.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle6
	{style-name:"개요 5"; margin-left:50.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle6
	{style-name:"개요 5"; margin-left:50.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle7
	{style-name:"개요 6"; margin-left:60.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle7
	{style-name:"개요 6"; margin-left:60.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle7
	{style-name:"개요 6"; margin-left:60.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle8
	{style-name:"개요 7"; margin-left:70.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle8
	{style-name:"개요 7"; margin-left:70.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle8
	{style-name:"개요 7"; margin-left:70.0pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle9
	{style-name:"쪽 번호"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle9
	{style-name:"쪽 번호"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle9
	{style-name:"쪽 번호"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:160%; font-size:10.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle10
	{style-name:"머리말"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:150%; font-size:9.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle10
	{style-name:"머리말"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:150%; font-size:9.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle10
	{style-name:"머리말"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:0.0pt; line-height:150%; font-size:9.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle11
	{style-name:"각주"; margin-left:13.1pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:-13.1pt; line-height:130%; font-size:9.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle11
	{style-name:"각주"; margin-left:13.1pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:-13.1pt; line-height:130%; font-size:9.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle11
	{style-name:"각주"; margin-left:13.1pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:-13.1pt; line-height:130%; font-size:9.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle12
	{style-name:"미주"; margin-left:13.1pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:-13.1pt; line-height:130%; font-size:9.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle12
	{style-name:"미주"; margin-left:13.1pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:-13.1pt; line-height:130%; font-size:9.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle12
	{style-name:"미주"; margin-left:13.1pt; margin-top:0.0pt; margin-bottom:0.0pt; text-align:justify; text-indent:-13.1pt; line-height:130%; font-size:9.0pt; font-family:함초롬바탕; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle13
	{style-name:"메모"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:left; text-indent:0.0pt; line-height:130%; font-size:9.0pt; font-family:함초롬돋움; letter-spacing:-5%; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle13
	{style-name:"메모"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:left; text-indent:0.0pt; line-height:130%; font-size:9.0pt; font-family:함초롬돋움; letter-spacing:-5%; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle13
	{style-name:"메모"; margin-top:0.0pt; margin-bottom:0.0pt; text-align:left; text-indent:0.0pt; line-height:130%; font-size:9.0pt; font-family:함초롬돋움; letter-spacing:-5%; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle14
	{style-name:"차례 제목"; margin-top:12.0pt; margin-bottom:3.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:16.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#2e74b5;}
li.HStyle14
	{style-name:"차례 제목"; margin-top:12.0pt; margin-bottom:3.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:16.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#2e74b5;}
div.HStyle14
	{style-name:"차례 제목"; margin-top:12.0pt; margin-bottom:3.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:16.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#2e74b5;}
p.HStyle15
	{style-name:"차례 1"; margin-top:0.0pt; margin-bottom:7.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:11.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle15
	{style-name:"차례 1"; margin-top:0.0pt; margin-bottom:7.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:11.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle15
	{style-name:"차례 1"; margin-top:0.0pt; margin-bottom:7.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:11.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle16
	{style-name:"차례 2"; margin-left:11.0pt; margin-top:0.0pt; margin-bottom:7.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:11.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle16
	{style-name:"차례 2"; margin-left:11.0pt; margin-top:0.0pt; margin-bottom:7.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:11.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle16
	{style-name:"차례 2"; margin-left:11.0pt; margin-top:0.0pt; margin-bottom:7.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:11.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
p.HStyle17
	{style-name:"차례 3"; margin-left:22.0pt; margin-top:0.0pt; margin-bottom:7.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:11.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
li.HStyle17
	{style-name:"차례 3"; margin-left:22.0pt; margin-top:0.0pt; margin-bottom:7.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:11.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
div.HStyle17
	{style-name:"차례 3"; margin-left:22.0pt; margin-top:0.0pt; margin-bottom:7.0pt; text-align:left; text-indent:0.0pt; line-height:160%; font-size:11.0pt; font-family:함초롬돋움; letter-spacing:0; font-weight:normal; font-style:normal; color:#000000;}
-->
</STYLE>
</HEAD>

<BODY>

<P CLASS=HStyle0 STYLE='line-height:130%;'><SPAN STYLE='font-size:14.0pt;font-family:"휴먼모음T";font-weight:bold;line-height:130%'>Logistic Regression </SPAN><SPAN STYLE='font-size:12.0pt;font-family:"휴먼모음T";line-height:130%'>(2018. 10. 27)</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>참고: <A HREF="http://https://www.youtube.com/watch?v=6vzchGYEJBc" TARGET="_self">https://www.youtube.com/watch?v=6vzchGYEJBc</A></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>일반적인 회귀분석은 크고 적은 값을 예측하는데 반해 로지스틱 회귀분석은 양의 개념이 아닌 질적 개념으로 예측하는 것이다. 예를 들면, 공부한 시간으로 합격, 불합격을 예측하거나, 인체 내 대장 사진으로 대장암인지 아닌지를 예측하는 것과 같다. 이와 같이 여러 가지 특징으로 “인지 아닌지”를 예측하는 경우는 회귀분석의 결과가 0인지 1인지 예측하는 결과와 같으며, 이러한 경우 일반적인 회귀분석 방법으로 예측하게 되면 (1) 예측이 잘못되거나 (2) 예측 값이 1보다 커질 수 있는 등 예측 정확도가 떨어진다. 이를 보완하기 위해서 예측 값을 sigmoid 함수에 통과시켜 구하게 되면</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><IMG src=".\PIC9044.gif" alt="" width="161" height="40" vspace="1" hspace="0" border="0">로 나타내며, 이러한 sigmoid 함수에 어떠한 수의 x를 넣어도 Sigmoid 함수는 0과 1사이의 수를 반환하므로 원하는 결과를 얻을 수 있다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>그러나 예측 값을 구하기 위해서 Sigmoid 함수를 사용할 경우 이 함수가 포함된 cost 함수는 울퉁불퉁해져서 미분으로 최소값을 구할 경우 그 최소값이 Global minima가 아니라 local minima가 될 수 있다. 즉, Sigmoid 함수만을 사용한 cost함수로는 정확한 예측 값을 구하기 어렵다는 의미이다. cost 함수의 이러한 단점을 보완하기 위해 cost함수도 아래 (3)과 같이 약간 바꾼다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>(1) 일반 회귀분석시 cost 함수 : <IMG src=".\PIC9064.gif" alt="" width="188" height="44" vspace="1" hspace="0" border="0">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <IMG src=".\PIC9075.gif" alt="" width="77" height="19" vspace="1" hspace="0" border="0"></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>(2) 로지스틱 회귀분석시 cost 함수 : <IMG src=".\PIC9085.gif" alt="" width="188" height="44" vspace="1" hspace="0" border="0">,&nbsp;&nbsp;&nbsp;&nbsp; <IMG src=".\PIC9096.gif" alt="" width="150" height="19" vspace="1" hspace="0" border="0"></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>(3) 로지스틱 회귀분석시 cost 함수(보완): <IMG src=".\PIC90A6.gif" alt="" width="369" height="44" vspace="1" hspace="0" border="0">, </P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<IMG src=".\PIC90B7.gif" alt="" width="150" height="19" vspace="1" hspace="0" border="0"></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><IMG src=".\PIC90C8.gif" alt="" width="10" height="19" vspace="1" hspace="0" border="0">은 0과 1 사이의 숫자이므로, 로지스틱 회귀분석 결과가 좋은 예측이 되기 위해서는 예측과 실제가 같아져야 하는데, 즉, <IMG src=".\PIC90D8.gif" alt="" width="10" height="19" vspace="1" hspace="0" border="0">가 0일 때 y도 0이고 <IMG src=".\PIC90E9.gif" alt="" width="10" height="19" vspace="1" hspace="0" border="0">가 1일 때 y도 1이 되어야 하는데 (3)의 경우 cost 함수가 작아질수록 이렇게 된다는 것이다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>즉, 예측과 실제가 같을 경우 (하나만 계산해 보면)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>
<TABLE border="1" cellspacing="0" cellpadding="0" style='border-collapse:collapse;border:none;'>
<TR>
	<TD valign="middle" style='width:64;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0>y = 0</P>
	</TD>
	<TD valign="middle" style='width:64;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0><IMG src=".\PIC90EA.gif" alt="" width="10" height="19" vspace="1" hspace="0" border="0">&nbsp;= 0</P>
	</TD>
	<TD valign="middle" style='width:506;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0><IMG src=".\PIC910A.gif" alt="" width="412" height="54" vspace="1" hspace="0" border="0"></P>
	</TD>
</TR>
<TR>
	<TD valign="middle" style='width:64;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0>y = 1</P>
	</TD>
	<TD valign="middle" style='width:64;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0><IMG src=".\PIC911B.gif" alt="" width="10" height="19" vspace="1" hspace="0" border="0">&nbsp;= 1</P>
	</TD>
	<TD valign="middle" style='width:506;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0><IMG src=".\PIC913B.gif" alt="" width="477" height="54" vspace="1" hspace="0" border="0"></P>
	</TD>
</TR>
</TABLE></P>
<P CLASS=HStyle0 STYLE='line-height:130%;'></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>반면, 예측과 실제가 다를 경우</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>
<TABLE border="1" cellspacing="0" cellpadding="0" style='border-collapse:collapse;border:none;'>
<TR>
	<TD valign="middle" style='width:64;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0>y = 1</P>
	</TD>
	<TD valign="middle" style='width:64;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0><IMG src=".\PIC914B.gif" alt="" width="10" height="19" vspace="1" hspace="0" border="0">&nbsp;= 0</P>
	</TD>
	<TD valign="middle" style='width:506;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0><IMG src=".\PIC916C.gif" alt="" width="493" height="54" vspace="1" hspace="0" border="0"></P>
	</TD>
</TR>
<TR>
	<TD valign="middle" style='width:64;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0>y = 0</P>
	</TD>
	<TD valign="middle" style='width:64;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0><IMG src=".\PIC917C.gif" alt="" width="10" height="19" vspace="1" hspace="0" border="0">&nbsp;= 1</P>
	</TD>
	<TD valign="middle" style='width:506;height:58;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0><IMG src=".\PIC919C.gif" alt="" width="489" height="54" vspace="1" hspace="0" border="0"></P>
	</TD>
</TR>
</TABLE></P>
<P CLASS=HStyle0 STYLE='line-height:130%;'></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>따라서 cost함수가 작아지도록 학습시키면 실제와 같은 예측결과를 얻을 수 있다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>파이토치 코드로 XOR 문제에 Logistic Regression 적용</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><SPAN STYLE='font-weight:bold'># XOR 문제1</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>import torch as t</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>import numpy as np</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>x = np.array([[0, 0], [0, 1], [1, 0], [1, 1]], dtype='float32')</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>y = np.array(<SPAN STYLE='font-weight:bold;color:#0000ff'>[[0], [1], [1], [0]],</SPAN> dtype='float32')</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>inputs = t.tensor(x)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>targets = t.tensor(y)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>t.manual_seed(777)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>w1 = t.randn(2,2, requires_grad=True)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>b1 = t.randn(2, requires_grad=True)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>w2 = t.randn(2,1, requires_grad=True)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>b2 = t.randn(1, requires_grad=True)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>def sigmoid(x):</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;return 1/(1+t.exp(-x))</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>def loss_fn(y_hat, y):</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;diff = -y*t.log2(y_hat)-(1-y)*t.log2(1-y_hat)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;loss = t.sum(diff) / diff.numel()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;return loss</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>lr = 0.1</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>for i in range(10001):</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;L1 = inputs @ w1 + b1</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;L1 = sigmoid(L1)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;L2 = L1 @ w2 + b2</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;preds = sigmoid(L2)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;loss = loss_fn(preds, targets)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;loss.backward()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;with t.no_grad():</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w1 -= w1.grad * lr</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1 -= b1.grad * lr</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w2 -= w2.grad * lr</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2 -= b2.grad * lr</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w1.grad.zero_()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1.grad.zero_()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w2.grad.zero_()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2.grad.zero_()</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>preds = t.round(preds)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>print(i, &quot;preds = &quot;, preds)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><SPAN STYLE='font-weight:bold'>[결과]</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>10000 preds = tensor(<SPAN STYLE='font-weight:bold;color:#0000ff'>[[0.]</SPAN>,</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN STYLE='font-weight:bold;color:#0000ff'>[1.],</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><SPAN STYLE='font-weight:bold;color:#0000ff'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1.],</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN STYLE='font-weight:bold;color:#0000ff'>[0.]]</SPAN>, grad_fn=&lt;RoundBackward&gt;)`</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>여태까지는 0, 1의 2가지를 분류할 때 사용하는 방법을 설명하였는데, 다음은 3가지 이상의 항목으로 분류할 경우를 설명하고자 한다. 예를 들면 A, B, C, D, E와 같이 5가지를 분류할 때의 방법이다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>예를 들어 이미지를 학습할 경우 여러 개의 Layers를 거쳐 나온 예측 수치들이 실제 수치와 비교할 때 예측 수치의 형태가 (:, 784)일 경우 Fully Connected로 연결하여 분류할 개수만큼 출력 수치를 뽑아낸다. 만약 분류할 라벨 개수가 10개일 경우 출력의 배열은 (:, 10)이 되고 가운데 weight는 (784, 10)이 된다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>
<TABLE border="1" cellspacing="0" cellpadding="0" style='border-collapse:collapse;border:none;'>
<TR>
	<TD valign="middle" style='width:106;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>입력</P>
	</TD>
	<TD valign="middle" style='width:106;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:106;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>weight</P>
	</TD>
	<TD valign="middle" style='width:106;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:212;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>출력</P>
	</TD>
</TR>
<TR>
	<TD valign="middle" style='width:106;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>(:, 784)</P>
	</TD>
	<TD valign="middle" style='width:106;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>*</P>
	</TD>
	<TD valign="middle" style='width:106;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>(784, 10)</P>
	</TD>
	<TD valign="middle" style='width:106;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>=</P>
	</TD>
	<TD valign="middle" style='width:212;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>(:, 10)</P>
	</TD>
</TR>
</TABLE></P>
<P CLASS=HStyle0 STYLE='line-height:130%;'></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>아래와 같이 출력 데이터가 들어 있을 경우 종전에는 sigmoid 함수를 거치고 끝냈으나 여기에서 한 번 더 처리하여 softmax 과정을 거친다. softmax 함수는 수치를 합이 1인 확률로 변환하고 변환과정에서 e 지수를 사용하여 크고 작은 것에 대한 차이를 확대해서 분류를 더 잘 할 수 있도록 하는 것이다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>
<TABLE border="1" cellspacing="0" cellpadding="0" style='border-collapse:collapse;border:none;'>
<TR>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>0</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>1</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>2</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>3</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>4</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>5</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>6</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>7</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>8</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:none;border-right:none;border-top:none;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>9</P>
	</TD>
</TR>
<TR>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>12</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>4</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>5</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>33</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>7</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>83</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>22</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>34</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>11</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>86</P>
	</TD>
</TR>
<TR>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>:</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
</TR>
<TR>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>:</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
	<TD valign="middle" style='width:30;height:17;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0 STYLE='text-align:center;'>&nbsp;</P>
	</TD>
</TR>
</TABLE></P>
<P CLASS=HStyle0 STYLE='line-height:130%;'></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>softmax 함수는 아래와 같이 나타낼 수 있으며 이 함수로 위의 수치를 변환하면 다음과 같다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>12를 변환할 경우 </P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>
<TABLE border="1" cellspacing="0" cellpadding="0" style='border-collapse:collapse;border:none;'>
<TR>
	<TD valign="middle" style='width:635;height:53;border-left:solid #000000 0.4pt;border-right:solid #000000 0.4pt;border-top:solid #000000 0.4pt;border-bottom:solid #000000 0.4pt;padding:1.4pt 5.1pt 1.4pt 5.1pt'>
	<P CLASS=HStyle0><IMG src=".\PIC91BD.gif" alt="" width="149" height="50" vspace="1" hspace="0" border="0"><IMG src=".\PIC91DD.gif" alt="" width="436" height="43" vspace="1" hspace="0" border="0"></P>
	</TD>
</TR>
</TABLE></P>
<P CLASS=HStyle0 STYLE='line-height:130%;'></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>각각의 수치도 이와 같이 변환하면 된다. 파이토치로 변환한 결과는 아래와 같다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>def softmax(x):</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;xx = x</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;for j in range(len(x)):</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx[j, :] = t.exp(x[j,:])/t.sum(t.exp(x[j,:]))</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;return xx</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>ex = np.array([[12, 4, 5, 33, 7, 83, 22, 34, 11, 86]], dtype='float32')</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>ex = t.tensor(ex)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>ex_s = softmax(ex)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>ex_s = ex_s * 10000</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>ex_r = t.round(ex_s)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>ex_r = ex_r/10000</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>print(ex_r)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><SPAN STYLE='font-weight:bold'>[결과]</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>tensor([[6.9360e-33, 2.3268e-36, 6.3248e-36, 9.1473e-24, 4.6734e-35, 4.7426e-02,</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.5277e-28, 2.4865e-23, 2.5516e-33, 9.5257e-01]])</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>소숫점 4자리에서 반올림하면</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0474, 0.0000, 0.0000, 0.0000, 0.9526]])</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>이 결과를 다시 one_hot_encoding으로 변환한다. one_hot_encoding은 가장 큰 수를 1로 놓고 나머지는 모두 0으로 놓는 것이다. 위의 수치를 one_hot_encoding으로 변환하면 </P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>def one_hot_encoding(y_hat):&nbsp; </P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;yy = t.exp(y_hat)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;xx = yy</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;for i in range(len(yy)):</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy[i, :] = yy[i, :]/t.sum(yy[i, :])</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values, indices = t.max(yy, 1)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx[i, :] = 0</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx[i, indices[i]] = 1&nbsp;&nbsp;&nbsp;&nbsp; </P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#d = indices.view(len(yy), 1)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;return xx</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>one = one_hot_encoding(ex_r)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>print(one)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>[결과]</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>tensor([[0., 0., 0., 0., 0., 0., 0., 0., 0., 1.]])</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>한편 학습을 위해서는 cost 함수를 만들어야 되는데 cost함수는 아래와 같다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>​</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><IMG src=".\PIC91ED.gif" alt="" width="203" height="33" vspace="1" hspace="0" border="0">, 여기서 합은 배열의 row 내에서 합이었으나 batch_size로 학습하므로 처음부터 전체요소의 합을 구하는 것이 낫다. 중요한 것은 여기서 <IMG src=".\PIC91EE.gif" alt="" width="12" height="23" vspace="1" hspace="0" border="0">를 one_hot_encoding 결과가 아니라 softmax결과, 즉 확률치를 대입하는 것이다. one_hot_encoding 수치를 대입할 경우 무한대가 포함되어 error가 발생한다.</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>종전의 XOR 구하는 예제를 이 방법으로 다시 해 보면 10,000의 반복 횟수를 26으로 줄일 수 있다. 물론 학습률도 0.1에서 2로 조정했지만..</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><SPAN STYLE='font-weight:bold'># XOR 문제2</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>import torch as t</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>import numpy as np</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>x = np.array([[0, 0], [0, 1], [1, 0], [1, 1]], dtype='float32')</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>y = np.array([<SPAN STYLE='font-weight:bold;color:#0000ff'>[0], [1], [1], [0]</SPAN>], dtype='float32')</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>inputs = t.tensor(x)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>targets = t.tensor(y)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>t.manual_seed(777)&nbsp; # seed를 고정한다.</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>w1 = t.randn(2,2, requires_grad=True)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>b1 = t.randn(2, requires_grad=True)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>w2 = t.randn(2,2, requires_grad=True)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>b2 = t.randn(2, requires_grad=True)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>def sigmoid(x):</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;return 1/(1+t.exp(-x))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp; <IMG src=".\PIC920F.gif" alt="" width="156" height="40" vspace="1" hspace="0" border="0"></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>def softmax(x):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # e지수화해서 row별로 확률을 계산</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;xx = x</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;for j in range(len(x)):</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx[j, :] = t.exp(x[j,:])/t.sum(t.exp(x[j,:]))</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;return xx</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>def one_hot_encoding(y_hat):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # row별 확률 중 가장 큰 것을 1, 나머지는 0으로 대체</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;yy = t.exp(y_hat)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;xx = yy</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;for i in range(len(yy)):</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy[i, :] = yy[i, :]/t.sum(yy[i, :])</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values, indices = t.max(yy, 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # row별 가장 큰 것의 값과 인덱스 반환</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx[i, :] = 0</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx[i, indices[i]] = 1&nbsp;&nbsp;&nbsp;&nbsp; </P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#d = indices.view(len(yy), 1)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;return xx</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>def loss_fn(preds, targets):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # <IMG src=".\PIC921F.gif" alt="" width="203" height="33" vspace="1" hspace="0" border="0"></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;diff = targets * (-t.log2(preds))</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;loss = t.sum(diff) </P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;return loss</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'># one_hot_encoding으로 비교하기 위해 실제값을 예측값과 같이 0, 1의 데이터로 바꾸어 주어야 한다.</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>def targets_one_hot(targets):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;target = t.zeros(len(targets), 2)&nbsp; </P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;for j in range(len(targets)):</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k = targets[j, 0].int()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target[j, k] = 1</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;return target</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>def labeling(preds):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # 예측 결과값에 당초의 데이터처럼 라벨을 붙인다.</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;p = t.zeros(len(preds), 1)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;values, indices = t.max(preds, 1)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;for i in range(len(preds)):</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i, 0] = indices[i]</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;return p</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>lr = 2</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>for i in range(26):</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;L1 = inputs @ w1 + b1</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;L1 = sigmoid(L1)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;L2 = L1 @ w2 + b2</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;L2 = sigmoid(L2)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;preds_s = softmax(L2) </P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;ta = targets_one_hot(targets)&nbsp;&nbsp; </P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;loss = loss_fn(preds_s, ta)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;print(i, &quot;loss = &quot;, loss)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;loss.backward()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;with t.no_grad():</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w1 -= w1.grad * lr</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1 -= b1.grad * lr</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w2 -= w2.grad * lr</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2 -= b2.grad * lr</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w1.grad.zero_()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1.grad.zero_()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w2.grad.zero_()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2.grad.zero_()</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;preds_ = one_hot_encoding(preds_s)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>&nbsp;&nbsp;&nbsp;&nbsp;print(i, &quot;preds_ = \n&quot;, preds_)</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>print(labeling(preds_))</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><SPAN STYLE='font-weight:bold'>[결과]</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>반복횟수 =&nbsp; 25</P>

<P CLASS=HStyle0 STYLE='line-height:100%;'>tensor([<SPAN STYLE='font-weight:bold;color:#0000ff'>[0.],</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><SPAN STYLE='font-weight:bold;color:#0000ff'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1.],</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><SPAN STYLE='font-weight:bold;color:#0000ff'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1.],</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:100%;'><SPAN STYLE='font-weight:bold;color:#0000ff'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0.]]</SPAN>)</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><SPAN STYLE='font-weight:bold'>참고. cost 함수 다시 정리</SPAN></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>(1) 일반 회귀분석시 cost 함수 : <IMG src=".\PIC9230.gif" alt="" width="188" height="44" vspace="1" hspace="0" border="0">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <IMG src=".\PIC9240.gif" alt="" width="77" height="19" vspace="1" hspace="0" border="0"></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>(2) 로지스틱 회귀분석시 cost 함수 : <IMG src=".\PIC9251.gif" alt="" width="188" height="44" vspace="1" hspace="0" border="0">,&nbsp;&nbsp;&nbsp;&nbsp; <IMG src=".\PIC9262.gif" alt="" width="150" height="19" vspace="1" hspace="0" border="0"></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>(3) 로지스틱 회귀분석시 cost 함수 (보완): <IMG src=".\PIC9272.gif" alt="" width="369" height="44" vspace="1" hspace="0" border="0">, </P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>(4) 로지스틱 회귀분석시 cost 함수 (다중 값으로 분류할 경우): <IMG src=".\PIC9283.gif" alt="" width="203" height="33" vspace="1" hspace="0" border="0"></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<IMG src=".\PIC9293.gif" alt="" width="173" height="54" vspace="1" hspace="0" border="0"></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

<P CLASS=HStyle0 STYLE='line-height:130%;'>(3)과 (4)는 같은 수식이라고 함</P>

<P CLASS=HStyle0 STYLE='line-height:130%;'><BR></P>

</BODY>

</HTML>
